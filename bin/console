#!/usr/bin/env ruby

require "bundler/setup"
require "pry"
require "byebug"
require "broken_link_finder"
require 'wgit/core_ext'
require 'httplog'

# Monkey patch all Net:HTTP network calls and log them.
HttpLog.configure do |config|
  config.log_connect    = false
  config.log_request    = true
  config.log_headers    = false
  config.log_data       = false
  config.log_status     = true
  config.log_response   = false
  config.log_benchmark  = true

  config.compact_log    = true
  config.json_log       = true
end

# Call reload to load all recent code changes.
def reload
  original_verbose = $VERBOSE
  $VERBOSE = nil # Temporarily suppress ruby warnings.
  load 'load.rb'
  include BrokenLinkFinder
  $VERBOSE = original_verbose # Restore ruby warnings.
  true
end

# You can add fixtures and/or initialization code here...
reload
url = "http://txti.es/"
by_page = Finder.new
by_link = Finder.new sort: :link
finder = by_page

binding.pry
